<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Ophelia Ravenshade ‚Äì Runenritual</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  /* OPHELIA ‚Äì LILA SORCERER MAGIE */
  --accent-main: rgba(190,140,255,.95);
  --accent-soft: rgba(150,90,230,.45);
  --accent-shadow: rgba(210,160,255,.7);
}

body{
  margin:0;
  padding:1rem;
  background:radial-gradient(circle at top,#241435 0%,#050308 75%);
  color:#eee;
  font-family:Georgia,serif;
}

.sub{
  text-align:center;
  opacity:.75;
  font-size:.8rem;
  margin-bottom:1rem;
}

/* ===== TITELBILD ===== */
.title-image{
  display:flex;
  justify-content:center;
  margin:.4rem 0 .6rem;
}
.title-image img{
  max-width:100%;
  width:420px;
  height:auto;
  filter:
    drop-shadow(0 0 18px var(--accent-shadow))
    drop-shadow(0 0 40px var(--accent-soft));
}

@media (max-width:600px){
  .title-image img{ width:88%; }
}

/* ===== DREHR√ÑDER ===== */
.wheels{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:.7rem;
  margin-bottom:1.2rem;
}
.wheel-column{ display:flex; flex-direction:column; }
.label{
  text-align:center;
  font-size:.7rem;
  letter-spacing:.16em;
  opacity:.75;
  margin-bottom:.2rem;
}

.wheel{
  border:1px solid #3a2a4a;
  border-radius:1rem;
  background:rgba(12,8,20,.85);
  padding:.3rem;
  height:220px;
  overflow-y:auto;
  scroll-snap-type:y mandatory;
  position:relative;
}

.spacer{ height:80px; }

.rune{
  scroll-snap-align:center;
  text-align:center;
  padding:.4rem 0;
  opacity:.35;
  transition:.25s ease;
}
.rune .symbol{ font-size:2rem; }
.rune .name{ font-size:.6rem; opacity:.7; }
.rune.active{
  opacity:1;
  transform:scale(1.15);
  text-shadow:0 0 14px var(--accent-main);
}

/* ===== ZENTRIER-LINIE ===== */
.wheel::after{
  content:"";
  position:absolute;
  top:50%;
  left:6%;
  right:6%;
  height:2px;
  transform:translateY(-50%);
  background:linear-gradient(90deg,transparent,var(--accent-main),transparent);
  box-shadow:
    0 0 10px var(--accent-main),
    0 0 22px var(--accent-soft);
  pointer-events:none;
}

.wheel::before{
  content:"";
  position:absolute;
  top:50%;
  left:0;
  right:0;
  height:46px;
  transform:translateY(-50%);
  background:radial-gradient(
    ellipse at center,
    rgba(180,120,255,.18) 0%,
    rgba(180,120,255,.08) 35%,
    transparent 70%
  );
  pointer-events:none;
}

/* ===== BUTTONS ===== */
#cast, #reset{
  width:100%;
  padding:.9rem;
  font-size:1rem;
  border-radius:1rem;
  border:1px solid #6c55a3;
}

#cast{
  background:linear-gradient(180deg,#4d2e78,#26133c);
}
#reset{
  margin-top:.6rem;
  background:linear-gradient(180deg,#2a2a3c,#14141f);
}

#cast:active,#reset:active{ transform:scale(.98); }

/* ===== RESULT ===== */
#result{
  margin-top:1rem;
  padding:1.2rem;
  border:2px solid #5a3d88;
  border-radius:1rem;
  background:radial-gradient(circle at top,#160b28 0%,#07040b 70%);
  box-shadow:0 0 28px var(--accent-soft);
  line-height:1.6;
  opacity:0;
  transform:translateY(8px);
  transition:.6s ease;
}
#result.show{ opacity:1; transform:none; }

hr{
  border:none;
  border-top:1px solid #34234f;
  margin:.8rem 0;
}
.small{ opacity:.7; font-size:.75rem; }

/* ===== LOCK ===== */
body.manifest .wheel{
  filter:grayscale(.6) brightness(.75);
  pointer-events:none;
  overflow:hidden;
}

/* ===== TRACKING ===== */
#effect-ui{
  margin-top:.6rem;
  padding:.6rem .8rem;
  border-radius:.8rem;
  background:rgba(10,6,18,.9);
  border:1px solid #4b356f;
  font-size:.8rem;
}
#effect-ui label{
  display:flex;
  gap:.4rem;
  margin-top:.35rem;
}
#effect-ui input{ background:#07030f; color:#eee; border:1px solid #5a3d88; }
</style>
</head>

<body>

<div class="title-image">
  <img src="https://i.imgur.com/jzezDVQ.png" alt="Runenritual ‚Äì Ophelia Ravenshade">
</div>

<div class="sub">
  Ophelia Ravenshade ¬∑ Tiefling Sorcerer ¬∑ Zirkel der Hexen<br>
  <span class="small">Lila Blut ¬∑ Wilde Magie ¬∑ Einmal pro Long Rest</span>
</div>

<div class="wheels">
  <div class="wheel-column"><div class="label">ANKER</div><div class="wheel" id="anker"></div></div>
  <div class="wheel-column"><div class="label">EID</div><div class="wheel" id="eid"></div></div>
  <div class="wheel-column"><div class="label">FLUSS</div><div class="wheel" id="fluss"></div></div>
</div>

<button id="cast">üîÆ RITUAL WIRKEN</button>
<button id="reset">üåô LONG REST</button>

<div id="result">
  <span class="small">Die Magie wartet auf Ophelias Willen‚Ä¶</span>
</div>

<script>
const CHARACTER_ID = "ophelia";

const STORAGE_KEY = `runenritual_${CHARACTER_ID}_v1`;
/* ===== RUNENZEICHEN ===== */
const RUNES = {
  Fehu:"·ö†", Uruz:"·ö¢", Thurisaz:"·ö¶", Ansuz:"·ö®",
  Raidho:"·ö±", Kenaz:"·ö≤", Gebo:"·ö∑", Wunjo:"·öπ",
  Berkano:"·õí", Tiwaz:"·õè", Algiz:"·õâ", Dagaz:"·õû",
  Ingwaz:"·õú", Laguz:"·õö", Mannaz:"·õó", Othala:"·õü",
  Sowilo:"·õä", Jera:"·õÉ", Isa:"·õÅ", Hagalaz:"·ö∫",
  Perthro:"·õà", Nauthiz:"·öæ", Eihwaz:"·õá"
};

/* ===== OMEN PRO ANKER ===== */
const OMEN = {
  Fehu:"Fehu tritt hervor ‚Äì Besitz verlangt F√ºhrung.",
  Uruz:"Uruz zeigt sich ‚Äì dein K√∂rper tr√§gt heute mehr.",
  Thurisaz:"Thurisaz blockiert den Weg ‚Äì Macht kommt durch Widerstand.",
  Ansuz:"Ansuz fl√ºstert ‚Äì Worte und Zauber h√∂ren zu.",
  Raidho:"Raidho rollt ‚Äì Bewegung formt das Schicksal.",
  Kenaz:"Kenaz brennt ‚Äì Wahrheit duldet keinen Schatten.",
  Gebo:"Gebo fordert Austausch ‚Äì nichts bleibt einseitig.",
  Wunjo:"Wunjo l√§chelt vorsichtig ‚Äì der Geist sucht Balance."
};

/* ===== 64 EFFEKTE (ANKER √ó EID) ===== */
const EFFECTS = {
  Fehu:{
    Berkano:"Erhalte 1d4 zus√§tzliche Ladungen f√ºr ein begrenztes Item.",
    Tiwaz:"Gold- oder Ressourcenaufwand z√§hlt einmalig als doppelt effektiv.",
    Algiz:"Ein Besitz kann einmal nicht gestohlen oder zerst√∂rt werden.",
    Dagaz:"Ein Handel oder Tausch gelingt automatisch.",
    Ingwaz:"Speichere einen Ressourcenbonus (bis 50 gp √Ñquivalent).",
    Laguz:"Nach Ressourcenverlust darfst du ihn einmal r√ºckg√§ngig machen.",
    Mannaz:"Advantage bei Checks mit wertvollen Gegenst√§nden.",
    Othala:"Ein Item ist bis zum n√§chsten Long Rest fest an dich gebunden."
  },
  Uruz:{
    Berkano:"Erhalte tempor√§re Trefferpunkte (1d6 + Proficiency Bonus).",
    Tiwaz:"+1d4 Schaden bei STR-basierten Angriffen (1√ó pro Runde).",
    Algiz:"Einmal pro Runde Resistance gegen physischen Schaden.",
    Dagaz:"Ein STR- oder CON-Rettungswurf gilt automatisch als bestanden.",
    Ingwaz:"Speichere +1d8 f√ºr einen k√∂rperlichen Wurf.",
    Laguz:"Nach einem Miss darfst du +1d4 hinzuf√ºgen.",
    Mannaz:"Advantage auf Athletics oder Acrobatics.",
    Othala:"Du kannst einmal nicht prone werden."
  },
  Thurisaz:{
    Berkano:"Dein erster Treffer verursacht +1d6 zus√§tzlichen Schaden.",
    Tiwaz:"+1 auf Attack Rolls (1√ó pro Runde).",
    Algiz:"Ignoriere einmal Shield oder √§hnliche parierende Effekte.",
    Dagaz:"Ein Angriff trifft automatisch (kein erzwungener Krit).",
    Ingwaz:"Speichere +1d10 zus√§tzlichen Schaden.",
    Laguz:"Nach einem verfehlten Angriff darfst du den Wurf wiederholen.",
    Mannaz:"Advantage auf Angriffe gegen ein ausgew√§hltes Ziel.",
    Othala:"Deine Waffe z√§hlt als magisch gegen Resistenz/Immunit√§t."
  },
  Ansuz:{
    Berkano:"Nach Wirken eines Zaubers erh√§ltst du Temp-TP = Zaubergrad √ó 2.",
    Tiwaz:"+1 auf Spell Attack oder Spell Save DC (f√ºr 1 Zauber).",
    Algiz:"Advantage auf Concentration Saves.",
    Dagaz:"Ein Zauber ignoriert Disadvantage.",
    Ingwaz:"Speichere einen +1-Zaubergrad-Effekt (z. B. extra Schaden/Ziele).",
    Laguz:"Nach Zauber-Fehlschlag +1d4 auf den n√§chsten Spell Attack.",
    Mannaz:"Advantage auf Arcana oder Religion.",
    Othala:"Ein Zauber ist an einen Ort oder ein Objekt gebunden."
  },
  Raidho:{
    Berkano:"Erhalte einen Bewegungs-Puffer von +10 ft.",
    Tiwaz:"+10 ft Bewegung, wenn du in deinem Zug angreifst.",
    Algiz:"Ignoriere Difficult Terrain.",
    Dagaz:"Du handelst in der n√§chsten Runde automatisch zuerst.",
    Ingwaz:"Speichere einen 10-ft-Teleport (Bonus Action).",
    Laguz:"Nach einer Opportunity Attack verliert der Gegner seine Reaktion.",
    Mannaz:"Advantage auf Initiative.",
    Othala:"Du kannst einmal nicht bewegt oder verschoben werden."
  },
  Kenaz:{
    Berkano:"+1d4 Bonus auf den n√§chsten Wahrnehmungs- oder Erkenntniswurf.",
    Tiwaz:"+1 auf Perception oder Investigation.",
    Algiz:"Advantage auf Checks gegen Illusionen.",
    Dagaz:"Du erh√§ltst automatisch einen wichtigen Hinweis der SL.",
    Ingwaz:"Speichere +1d8 f√ºr einen Erkenntniswurf.",
    Laguz:"Nach Fehlschlag darfst du einen Wahrnehmungswurf wiederholen.",
    Mannaz:"Advantage auf Insight.",
    Othala:"Ein Ort bleibt f√ºr dich immer erkennbar und leicht auffindbar."
  },
  Gebo:{
    Berkano:"Erhalte einen sozialen Gunst-Token (kleiner Gefallen, SL legt fest).",
    Tiwaz:"+1 auf CHA-basierte Checks.",
    Algiz:"Du bist einmalig immun gegen Charm-Effekte.",
    Dagaz:"Eine Bitte wird automatisch akzeptiert (im Rahmen des M√∂glichen).",
    Ingwaz:"Speichere Advantage f√ºr einen sp√§teren sozialen Wurf.",
    Laguz:"Nach Ablehnung darfst du einmal einen zweiten Versuch starten.",
    Mannaz:"Advantage auf Persuasion oder Deception.",
    Othala:"Ein NPC h√§lt dir gegen√ºber sicher sein Wort."
  },
  Wunjo:{
    Berkano:"Erhalte tempor√§re TP, die nur bei psychischem Schaden verbraucht werden.",
    Tiwaz:"+1 auf Rettungsw√ºrfe.",
    Algiz:"Resistance gegen Fear oder Charm.",
    Dagaz:"Ein WIS- oder CHA-Save gilt automatisch als bestanden.",
    Ingwaz:"Speichere +1d10 Bonus auf einen Save.",
    Laguz:"Nach einem misslungenen Save darfst du den Wurf wiederholen.",
    Mannaz:"Advantage auf WIS- oder CHA-Saves.",
    Othala:"Du kannst einmal nicht frightened werden."
  }
};

/* ===== EFFEKT-METADATEN ===== */
const EFFECT_META = {
  Fehu:{
    Berkano:"charges",
    Tiwaz:"single_use",
    Algiz:"item_bound",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"item_bound"
  },
  Uruz:{
    Berkano:"ongoing_buff",
    Tiwaz:"charges",
    Algiz:"ongoing_buff",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"single_use"
  },
  Thurisaz:{
    Berkano:"single_use",
    Tiwaz:"ongoing_buff",
    Algiz:"single_use",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"item_bound"
  },
  Ansuz:{
    Berkano:"ongoing_buff",
    Tiwaz:"single_use",
    Algiz:"ongoing_buff",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"item_bound"
  },
  Raidho:{
    Berkano:"ongoing_buff",
    Tiwaz:"ongoing_buff",
    Algiz:"ongoing_buff",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"single_use"
  },
  Kenaz:{
    Berkano:"single_use",
    Tiwaz:"ongoing_buff",
    Algiz:"ongoing_buff",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"ongoing_buff"
  },
  Gebo:{
    Berkano:"social_token",
    Tiwaz:"ongoing_buff",
    Algiz:"single_use",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"social_token"
  },
  Wunjo:{
    Berkano:"ongoing_buff",
    Tiwaz:"ongoing_buff",
    Algiz:"ongoing_buff",
    Dagaz:"single_use",
    Ingwaz:"charges",
    Laguz:"single_use",
    Mannaz:"ongoing_buff",
    Othala:"single_use"
  }
};

/* ===== FLUSS-RUNEN ===== */
const FLUSS = {
  Sowilo:{
    dur:"Bis zum n√§chsten Long Rest",
    price:"Kein zus√§tzlicher Preis."
  },
  Jera:{
    dur:"24 Stunden (verz√∂gert wirksam)",
    price:"Der Effekt kann nicht vorzeitig beendet werden."
  },
  Isa:{
    dur:"1 Encounter",
    price:"Deine Bewegung ist halbiert oder deine Bonusaktion blockiert."
  },
  Hagalaz:{
    dur:"1 Encounter",
    price:"Du erleidest 1d6 Schaden beim Wirken des Rituals."
  },
  Perthro:{
    dur:"Bis ein passender Trigger eintritt",
    price:"Tritt kein Trigger ein, verursacht die Magie eine kleine Fehlwirkung."
  },
  Nauthiz:{
    dur:"Bis zum n√§chsten Long Rest",
    price:"Du erleidest 1 Stufe Ersch√∂pfung."
  },
  Eihwaz:{
    dur:"Bis eine klare Schwelle erreicht ist",
    price:"Nach Ausl√∂sung hast du Nachteil auf deinen n√§chsten Wurf."
  },
  Algiz:{
    dur:"Bis zum n√§chsten Long Rest",
    price:"Der Effekt ist leicht abgeschw√§cht, aber vor Gegenmagie gesch√ºtzt."
  }
};

let pick = { anker:null, eid:null, fluss:null };

const STORAGE_KEY = `runenritual_${CHARACTER_ID}_v1`;


/* ===== DREHRAD MIT 5√ó WIEDERHOLUNG ===== */
function buildWheel(id, keys, storeKey){
  const el = document.getElementById(id);
  const repeat = 5;
  const centerIndex = 2;
  const runes = [];

  const top = document.createElement("div");
  top.className = "spacer";
  el.appendChild(top);

  for(let i=0;i<repeat;i++){
    keys.forEach(name=>{
      const d = document.createElement("div");
      d.className = "rune";
      d.dataset.value = name;
      d.innerHTML = `
        <div class="symbol">${RUNES[name]}</div>
        <div class="name">${name}</div>
      `;
      el.appendChild(d);
      runes.push(d);
    });
  }

  const bottom = document.createElement("div");
  bottom.className = "spacer";
  el.appendChild(bottom);

  requestAnimationFrame(()=>{
    if(!runes.length) return;
    const runeHeight = runes[0].offsetHeight || 1;
    const block = runeHeight * keys.length;
    el.scrollTop = block * centerIndex;

    const rect = el.getBoundingClientRect();
    let best = null;
    let bestDist = Infinity;
    runes.forEach(node=>{
      const r = node.getBoundingClientRect();
      const d = Math.abs((r.top + r.height/2) - (rect.top + rect.height/2));
      if(d < bestDist){ bestDist = d; best = node; }
    });
    if(best){
      runes.forEach(n=>n.classList.remove("active"));
      best.classList.add("active");
      pick[storeKey] = best.dataset.value;
    }
  });

  el.addEventListener("scroll",()=>{
    if(!runes.length) return;
    const runeHeight = runes[0].offsetHeight || 1;
    const block = runeHeight * keys.length;

    const lowerThreshold = block * (centerIndex - 1.5);
    const upperThreshold = block * (centerIndex + 1.5);

    if(el.scrollTop < lowerThreshold){
      el.scrollTop += block * 2;
    } else if(el.scrollTop > upperThreshold){
      el.scrollTop -= block * 2;
    }

    const rect = el.getBoundingClientRect();
    let best = null;
    let bestDist = Infinity;
    runes.forEach(node=>{
      const r = node.getBoundingClientRect();
      const d = Math.abs((r.top + r.height/2) - (rect.top + rect.height/2));
      if(d < bestDist){
        bestDist = d;
        best = node;
      }
    });

    if(best){
      runes.forEach(n=>n.classList.remove("active"));
      best.classList.add("active");
      pick[storeKey] = best.dataset.value;
    }
  });
}

/* ===== R√ÑDER AUFBAUEN ===== */
buildWheel("anker", Object.keys(OMEN), "anker");
buildWheel("eid", Object.keys(EFFECTS.Fehu), "eid");
buildWheel("fluss", Object.keys(FLUSS), "fluss");

/* ===== HILFSFUNKTION: TRACKING-UI ERZEUGEN ===== */
function buildTrackingUI(anker, eid){
  const metaType = EFFECT_META[anker]?.[eid] || null;
  if(!metaType) return "";

  let controls = "";

  switch(metaType){
    case "single_use":
      controls = `
        <label>
          <input type="checkbox" id="effect-used">
          <span>Effekt wurde bereits eingesetzt</span>
        </label>
        <small>Dieser Effekt ist nur einmal pro Ritual nutzbar.</small>
      `;
      break;
    case "charges":
      controls = `
        <label>
          <span>Ladungen verbleibend:</span>
          <input type="number" id="effect-charges" min="0" step="1" value="1">
        </label>
        <small>Nutze dieses Feld, um verbrauchte Ladungen mitzuz√§hlen.</small>
      `;
      break;
    case "item_bound":
      controls = `
        <label>
          <span>Gebunden an Gegenstand:</span>
          <input type="text" id="effect-item" placeholder="Name oder Beschreibung">
        </label>
        <small>Merke dir, welches Item von diesem Effekt gepr√§gt ist.</small>
      `;
      break;
    case "social_token":
      controls = `
        <label>
          <span>Wer schuldet dir etwas?</span>
          <input type="text" id="effect-social" placeholder="Name / Gruppe / Ort">
        </label>
        <small>Notiere, wer dir den Gefallen schuldet.</small>
      `;
      break;
    case "ongoing_buff":
      controls = `
        <label>
          <input type="checkbox" id="effect-active" checked>
          <span>Buff ist aktuell aktiv</span>
        </label>
        <small>Nutze das H√§kchen, um dir zu merken, ob der Effekt noch wirkt.</small>
      `;
      break;
    default:
      return "";
  }

  return `
    <div id="effect-ui">
      <b>üßø TRACKING</b><br>
      ${controls}
    </div>
  `;
}

function saveRitualState(){
  const state = {
    pick,
    manifest: document.body.classList.contains("manifest"),
    tracking: {}
  };

  const ui = document.getElementById("effect-ui");
  if(ui){
    ui.querySelectorAll("input").forEach(input=>{
      if(input.type === "checkbox"){
        state.tracking[input.id] = input.checked;
      } else {
        state.tracking[input.id] = input.value;
      }
    });
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

function loadRitualState(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(!raw) return;

  try{
    const state = JSON.parse(raw);
    if(!state.pick) return;

    pick = state.pick;

    // Ergebnis erneut anzeigen
    document.body.classList.add("manifest");

    const omen  = OMEN[pick.anker];
    const effectText = EFFECTS[pick.anker][pick.eid];
    const flow  = FLUSS[pick.fluss];
    const trackingHtml = buildTrackingUI(pick.anker, pick.eid);

    const res = document.getElementById("result");
    res.innerHTML = `
      <b>üïØÔ∏è OMEN</b><br><i>${omen}</i>
      <hr>
      <b>‚öîÔ∏è EFFEKT</b><br>
      ${effectText}<br>
      <b>Dauer:</b> ${flow.dur}
      <hr>
      <b>‚ö†Ô∏è PREIS</b><br>
      ${flow.price}
      <hr>
      ${trackingHtml}
      <span class="small">
        Runenritual: 1√ó pro Long Rest ¬∑ Effekte stapeln nicht mit sich selbst.
      </span>
    `;
    res.classList.add("show");

    // Tracking-Werte zur√ºcksetzen
    if(state.tracking){
      Object.entries(state.tracking).forEach(([id,val])=>{
        const el = document.getElementById(id);
        if(!el) return;
        if(el.type === "checkbox") el.checked = val;
        else el.value = val;
      });
    }
  }catch(e){
    console.warn("Runenritual konnte Zustand nicht laden", e);
  }
}

/* ===== RITUAL WIRKEN ===== */
document.getElementById("cast").onclick = () => {
  document.body.classList.add("manifest");

  if(!pick.anker || !pick.eid || !pick.fluss) return;

  const omen  = OMEN[pick.anker];
  const effectText = EFFECTS[pick.anker][pick.eid];
  const flow  = FLUSS[pick.fluss];

  const trackingHtml = buildTrackingUI(pick.anker, pick.eid);

  const res = document.getElementById("result");
  res.innerHTML = `
    <b>üïØÔ∏è OMEN</b><br><i>${omen}</i>
    <hr>
    <b>‚öîÔ∏è EFFEKT</b><br>
    ${effectText}<br>
    <b>Dauer:</b> ${flow.dur}
    <hr>
    <b>‚ö†Ô∏è PREIS</b><br>
    ${flow.price}
    <hr>
    ${trackingHtml}
    <span class="small">
      Runenritual: 1√ó pro Long Rest ¬∑ Effekte stapeln nicht mit sich selbst.
    </span>
  `;
  res.classList.add("show");
  saveRitualState();
};

/* ===== LONG REST / RESET ===== */
document.getElementById("reset").onclick = () => {
  localStorage.removeItem(STORAGE_KEY); // ‚úÖ HIER
  document.body.classList.remove("manifest");
  const res = document.getElementById("result");
  res.classList.remove("show");
  res.innerHTML = `
    <span class="small">
      Ein neuer Tag bricht an. Die Runen schweigen.
    </span>
  `;
};
  document.addEventListener("change", e=>{
  if(e.target.closest("#effect-ui")){
    saveRitualState();
  }
});
document.addEventListener("input", e=>{
  if(e.target.closest("#effect-ui")){
    saveRitualState();
  }
});
loadRitualState();

</script>
</body>
</html>
